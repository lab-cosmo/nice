

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utilities &mdash; NICE  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/togglebutton.js"></script>
        <script type="text/javascript">var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledgements" href="acknowledgements.html" />
    <link rel="prev" title="Blocks" href="blocks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NICE
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Theory in a nutshell</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory in a nutshell</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="symlinks/constructing_machine_learning_potential.html">Constructing machine learning potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_covariants.html">Calculating covariants</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_insights_about_the_model.html">Getting insights about the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructor_or_non_standard_sequence.html">Constructor or non standard sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequential_fitting.html">Sequential fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_regressors_into_purifiers.html">Custom regressors into purifiers</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="blocks.html">Blocks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Acknowledgements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NICE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/utilities.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-utilities">
<span id="utilities"></span><h1>Utilities<a class="headerlink" href="#module-utilities" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="utilities.get_all_species">
<code class="sig-prename descclassname">utilities.</code><code class="sig-name descname">get_all_species</code><span class="sig-paren">(</span><em class="sig-param">structures</em><span class="sig-paren">)</span><a class="headerlink" href="#utilities.get_all_species" title="Permalink to this definition">¶</a></dt>
<dd><p>getting all unique atomic species among the structures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structures</strong> – list of ase atoms objects</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sorted numpy array with ints with all unique species in the format where
1 states for H, 2 for He and so on. (inherits from ase function
atoms_object.get_atomic_numbers())</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utilities.get_compositional_features">
<code class="sig-prename descclassname">utilities.</code><code class="sig-name descname">get_compositional_features</code><span class="sig-paren">(</span><em class="sig-param">structures</em>, <em class="sig-param">all_species</em><span class="sig-paren">)</span><a class="headerlink" href="#utilities.get_compositional_features" title="Permalink to this definition">¶</a></dt>
<dd><p>getting compositional features suitable for linear regression which contains information
about the number of atoms with particular species in the structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – list of Ase atoms objects</p></li>
<li><p><strong>all_species</strong> – numpy array with ints of all unique species in the dataset.         If all species argument is the same for several calls of this function, resulting         blocks of compositional features are guaranteed to be consisted with each other</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array with shape [len(structures), len(all_species)] with compositional features</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utilities.get_spherical_expansion">
<code class="sig-prename descclassname">utilities.</code><code class="sig-name descname">get_spherical_expansion</code><span class="sig-paren">(</span><em class="sig-param">structures</em>, <em class="sig-param">rascal_hypers</em>, <em class="sig-param">all_species</em>, <em class="sig-param">task_size=100</em>, <em class="sig-param">num_threads=None</em>, <em class="sig-param">show_progress=True</em><span class="sig-paren">)</span><a class="headerlink" href="#utilities.get_spherical_expansion" title="Permalink to this definition">¶</a></dt>
<dd><p>getting spherical expansion coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – list of Ase atoms objects</p></li>
<li><p><strong>rascal_hypers</strong> – dictionary with parameters for librascal controlling spherical expansion</p></li>
<li><p><strong>all_species</strong> – numpy array with ints of all unique species in the dataset.         If all species argument is the same for several calls of this function, resulting         blocks of spherical expansion coefficients are guaranteed to be consisted with each other</p></li>
<li><p><strong>task_size</strong> – number of structures in chunk for multiprocessing</p></li>
<li><p><strong>num_threads</strong> – number of threads in multiprocessing. If None than all available         (len(os.sched_getaffinity(0))) threads are used</p></li>
<li><p><strong>show_progress</strong> – whether or not show progress via tqdm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary in which keys are elements of all_speceis and entries are numpy arrays with indexing
[environmental index, radial basis/neighbor specie index, lambda, m] with spherical expansion coefficients for
environments around atoms with specie indicated in key. Coefficients are stored from the beginning,
i. e. [:, : lambda, :(2 * lambda + 1)] elements are valid</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utilities.make_structural_features">
<code class="sig-prename descclassname">utilities.</code><code class="sig-name descname">make_structural_features</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">structures</em>, <em class="sig-param">all_species</em>, <em class="sig-param">show_progress=True</em><span class="sig-paren">)</span><a class="headerlink" href="#utilities.make_structural_features" title="Permalink to this definition">¶</a></dt>
<dd><p>getting structural features suitable for linear regression which consist of sums      over atomic features</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – nested dictionary with atomic features. First level keys are central species,         second level keys are body orders. Entries are 2-dimensional numpy arrays.</p></li>
<li><p><strong>structures</strong> – list of Ase atoms objects</p></li>
<li><p><strong>all_species</strong> – numpy array with ints of all unique species in the dataset.         If all species argument is the same for several calls of this function, resulting         blocks of structural features are guaranteed to be consistent with each other.           If for given block of structures there are no atoms of some particular specie,        features dictionary still have to contain key with this specie. It should contain         numpy arrays with shapes [0, number of features]. This is need to get proper placing        of features to fulfill consistency.</p></li>
<li><p><strong>show_progress</strong> – whether or not show progress via tqdm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array with shape [len(structures), number of structural features] with structural features</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utilities.transform_sequentially">
<code class="sig-prename descclassname">utilities.</code><code class="sig-name descname">transform_sequentially</code><span class="sig-paren">(</span><em class="sig-param">nice</em>, <em class="sig-param">structures</em>, <em class="sig-param">rascal_hypers</em>, <em class="sig-param">all_species</em>, <em class="sig-param">block_size=500</em>, <em class="sig-param">show_progress=True</em><span class="sig-paren">)</span><a class="headerlink" href="#utilities.transform_sequentially" title="Permalink to this definition">¶</a></dt>
<dd><p>transforming structures into structural features by chunks in order to use less amount of RAM</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nice</strong> – dictionary where keys are species and entries are nice transformers.        If you want to use single nice transformer to all environments regardless of central        specie just pass {key : nice_single for specie in all_species}</p></li>
<li><p><strong>structures</strong> – list of Ase atoms objects</p></li>
<li><p><strong>rascal_hypers</strong> – dictionary with parameters for librascal controlling spherical expansion.        Should be the same as used for fitting nice transformers</p></li>
<li><p><strong>all_species</strong> – numpy array with ints of all unique species in the dataset.</p></li>
<li><p><strong>block_size</strong> – size of chunks measured in number of environments</p></li>
<li><p><strong>show_progress</strong> – whether or not show progress via tqdm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array with shape [len(structures), number of structural features] with structural features</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="acknowledgements.html" class="btn btn-neutral float-right" title="Acknowledgements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blocks.html" class="btn btn-neutral float-left" title="Blocks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jigyasa Nigam, Sergey Pozdnyakov, Michele Ceriotti

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>